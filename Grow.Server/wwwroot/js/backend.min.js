function createFillFormAction(){return n=>{$("input, select").each((t,i)=>{var r=$(i).attr("name");r&&(r=r.substring(0,1).toLowerCase()+r.substring(1),r!=="isActive")&&(n[r]&&$(i).val(n[r]),$(i).attr("type")==="checkbox"&&$(i).prop("checked",n[r]),$(i).trigger("change"))})}}function createSetInputAction(n,t){return i=>{$("#"+n).val(i.id),t&&$("#"+t).val(i.name)}}$.prototype.getUrlParameter=function(n){var t=new RegExp("[?&]"+n+"=([^&#]*)").exec(window.location.search);return t!==null?t[1]||0:!1};$.prototype.stringCompareInsensitive=function(n,t){return n===t?!0:String(n).toLowerCase()===String(t).toLowerCase()};$.prototype.updateUrlParameter=function(n,t,i=window.location.href){var f="",r=i.split("?"),e=r[0],s=r[1],o="",u,h;if(s)for(r=s.split("&"),u=0;u<r.length;u++)r[u].split("=")[0]!==String(n)&&(f+=o+r[u],o="&");return t===0||t?(h=o+""+n+"="+t,e+"?"+f+h):f?e+"?"+f:e};url_search_entities_prefix="/Admin/Api/";$.fn.entitySearch=function(n){var t;n||(n=()=>{});this.on("keyup",i=>{var u=i.target,s=$(u).attr("dat-type"),f=$(u).attr("dat-year"),h=url_search_entities_prefix+s,c=$(u).attr("dat-output"),r=$("#"+c),e=$(u).val(),o=$.now(),l=t=>{var h,c,f,i,e,s;if($(u).removeClass("loading"),h=r.attr("output-version"),h===undefined||!(h>o)){for($(r).show(),r.attr("output-version",o),r.html("<li disabled>-- Select or search again --<\/li>"),c=0,f=0;f<t.length&&f<6;f++)i=t[f],e=i.name,i.contestId?e+=" ("+contest_years[i.contestId]+")":i.createdAt&&(e+=" (created at "+i.createdAt.substring(0,10)+")"),s=document.createElement("li"),s.innerHTML=e,s.addEventListener("click",()=>{$(r).hide(),n(i)}),r.append(s);t.length>6&&r.append("<li disabled>...<\/li>")}},a=()=>{$(u).removeClass("loading");var n="Error fetching entities via AJAX";console.log(n);r.append("<li>"+n+"<\/li>")};if(clearTimeout(t),e===""){r.hide();return}t=setTimeout(()=>{$(u).addClass("loading");var n={search:e};f&&(n.year=f);$.get(h,n,l).fail(a)},2e3)});return this};url_create_file_prefix="/Admin/Api/File?category=";url_get_file_prefix="/Admin/Api/File/";$.fn.imageUploader=function(){this.on("change",n=>{for(var e,o,i=n.target,s=$(i).attr("dat-category"),t=$("#"+$(i).attr("dat-output")),u=i.files,f=new FormData,r=0;r<u.length;r++)f.append("fileData",u[r]);e=n=>{var i,r,u;if(t.removeClass("loading"),t.length>0){for(r=0;r<n.length;r++)u=n[r],i=document.createElement("option"),i.innerText=u.name,i.value=u.id,t.append(i);i&&(i.selected=!0);t.trigger("change")}};o=n=>{t.removeClass("loading");switch(n.status){case 409:alert("Error: A file with this name has already been uploaded.");break;case 404:alert("Misconfiguration: Trying to save file to a nonexistent folder.");break;case 500:alert("Error: No storage connection could be established.")}console.log("Error fetching entities via AJAX")};t.addClass("loading");$.ajax({url:url_create_file_prefix+s,type:"POST",dataType:"json",data:f,contentType:!1,processData:!1,success:e,error:o})});return this};$.fn.imagePreviewer=function(){this.on("change",n=>{var r=$(n.target),e=r.find(":selected"),t=$("#"+r.attr("dat-preview")),i=e.val(),u,f;if(i){if(u=n=>{var i=n.url;t.attr("src",i);t.css("display","block")},f=n=>{var t="Error fetching selected image via AJAX: "+n.status;console.log(t)},!i){t.css("display","none");return}$.getJSON(url_get_file_prefix+i).done(u).error(f)}});return this};$.fn.conditionalCollapse=function(){this.each((n,t)=>{var e=$(t).attr("data-if"),i=$(t).attr("data-eq"),o=$(t).attr("data-neq"),f=i!==undefined?!0:!1,r=i!==undefined?i:o,u=$("[name='"+e+"']");if(r!==undefined&&u){u.on("change",n=>{$(n.target).val()===r===f?$(t).collapse("show"):$(t).collapse("hide")});u.val()===r!==f&&$(t).addClass("collapse")}})};url_select_year="/Admin/Home/SetYear";var debug;$(document).ready(function(){var n=$("#contest-selector");n.change(function(){var t=n.children("option:selected").val();$.post(url_select_year,{year:t},function(){location.reload()})});$(".pagination").each((n,t)=>{$(t).pagination({pages:$(t).attr("max"),currentPage:$(t).attr("current")})});$("input[type='date']").flatpickr({dateFormat:"d.m.Y"});$("input[type='datetime-local']").flatpickr({altInput:!0,altFormat:"d.m.Y H:i",enableTime:!0,time_24hr:!0});$(".conditional").conditionalCollapse();$(".img-selector input[type=file]").imageUploader();$(".img-selector select").imagePreviewer();$(".img-selector select").trigger("change");$("#copy-entity-box .search-input").entitySearch(createFillFormAction());$(".search-entity-box").each((n,t)=>{var r=$(t).attr("dat-id"),i=$(t).find(".search-input");i.entitySearch(createSetInputAction(r,i.attr("id")))})});